<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Devin Merullo">
<meta name="dcterms.date" content="2025-07-02">

<title>Devin Merullo, Ph.D.&nbsp;- Why the Chronology of The Legend of Zelda Keeps Me Up At Night</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Devin Merullo, Ph.D.</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html" rel="" target="">
 <span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../writing.html" rel="" target="">
 <span class="menu-text">Writing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../misc.html" rel="" target="">
 <span class="menu-text">Misc.</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Why the Chronology of <em>The Legend of Zelda</em> Keeps Me Up At Night</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Devin Merullo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-07-02</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><em>The Legend of Zelda</em> timeline has always bothered me. Well, not <em>always</em>– it made perfect sense to me as I played the games when they were released, until 2011, when perhaps in response to endless arguments from fans, Nintendo published an official timeline that linked the games together. Since this was straight from the source– the definition of canon– it’s now a settled topic, and there is no longer any room for debate. Right?</p>
<p>Consider this my Ninety-five Theses against the Church of Nintendo.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>I know, I know– it’s a fictional timeline for a corporate-owned video game series. I shouldn’t be worked up about it. But it’s also my favorite media franchise, and its world and narratives have lived in my imagination longer than any other creative piece: when you’re 7 years old, the characters that first spark you to start writing your own stories prove to be indelible. I’m not bothered by the <em>Zelda</em> timeline because it upsets my pre-conceived notion of how the games align. I’m irked because it rebukes the very logic and cohesion that made it so memorable in the first place, which does dim the magic, if ever so slightly. Beauty may not be immortal in art after all, however much da Vinci would disagree.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The first game in the eponymous series, <em>The Legend of Zelda</em>, was released in 1986 in Japan, with its English localization arriving in North America in 1987. The game’s principal creator, Shigeru Miyamoto, who also launched many other now-legendary Nintendo franchises such as <em>Mario</em> and <em>Donkey Kong</em>, was inspired by exploring nature around his childhood area of Kyoto. At the time, <em>The Legend of Zelda</em> provided an unparalleled adventuring experience, where players could navigate an expansive world with a novel freedom unlike in any game before it. The gameplay holds up well today, and its influence on video games as a whole cannot be overstated. More than anything else, <em>Zelda</em> to me represents exploration, and perhaps for this reason alone, the story of the original game is quite simple.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/zelda-timeline-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><em>Promotional artwork for the first game. Technology may have changed over the decades, but our sense of awe has not.</em></p>
<p>The player begins the game as the protagonist Link (<strong>not</strong> Zelda) thrust <em>in media res</em>, or rather, <em>in media nil.</em> The game’s setting, The Kingdom of Hyrule, has recently been decimated by the evil villain Ganon, and its inhabitants are reduced to living in caves to avoid the now ever-present dangers. Ganon was able to rise to power by obtaining a golden triangle known as, well, the Triforce of Power. Not content with just this, Ganon next desires the Triforce of Wisdom, and presumably not so he can better exercise great responsibility alongside great power. Princess Zelda (the one in the title!), bearing the Triforce of Wisdom, decides to split it into eight pieces and scatter it throughout the land so that Ganon may never obtain it. Prior to her capture by Ganon, Zelda tasks her royal caretaker Impa with finding a hero who can re-assemble the Triforce of Wisdom, defeat Ganon with his Triforce of Power, and save Hyrule. After a chance encounter where Link rescues Impa from Ganon’s minions, she implores him to arise as the kingdom’s only hope.</p>
<p>By the standards of high fantasy, it’s not a particularly complex plot. I don’t consider it a spoiler to summarize what happens next in a story released nearly 40 years ago: Link gathers all the components of the Triforce of Wisdom, defeats Ganon, saves Zelda, and returns peace to Hyrule.</p>
<p>All of this continues in the next game in the series, <em>Zelda II: The Adventure of Link</em> (the only title that’s numerical, lacks the words “The Legend of”, or mentions Link). As a direct sequel to the first, it’s set several years later, and centers around Link’s quest for the not-yet-previously mentioned Triforce of Courage. Up until now, the term “Triforce” had originally referred to the triangular shape of the objects, but from now on in the series, “Triforce” means the combined three pieces of Power, Wisdom, and Courage. This precisely leads us to the third game, <em>The Legend of Zelda: A Link to the Past</em> (known as <em>Triforce of the Gods</em> in Japan, which sounds more ominous and makes this connection to the Triforce more explicit), which illustrates a prequel to the original game. A cunning thief named Ganondorf serendipitously obtained the full Triforce, transformed into the evil demon king Ganon, and threatened Hyrule with all his horrific might. In an event known as the Imprisoning War, Hyrule’s Royal Knights waged battle against Ganon, and ultimately a group of mystical sages sealed him away in another realm. This worked well for quite some time, but then Hyrule requires Link’s courage to prevent Ganon from breaking out.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/zelda-timeline-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><em>Official artwork in the instruction booklet for A Link to the Past of the sages using the Triforce to seal Ganon away. Sometimes the Imprisoning War is referred to as the Seal War.</em></p>
<p>Forgive me, die-hard fans, for skipping over the fourth entry, <em>The Legend of Zelda: Link’s Awakening</em>, an excellent game and one of my favorites, but one that presents more of a side-story that distracts from the main issue I want to highlight.</p>
<p>That brings us to the fifth one. The big one. <em>The Legend of Zelda: Ocarina of Time</em>. I won’t comment on this game’s significance to video game innovations, as that has been well-told many times already, but I <em>will</em> harp on what this game means for the <em>Zelda</em> timeline, why I have a problem with what Nintendo did with it, and why I support an alternative fan framework.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>Interviews with the game’s developers around the time of its release stated that <em>Ocarina of Time</em> was meant to portray the Imprisoning War, the event that led to Ganon being sealed from Hyrule prior to the start of <em>A Link to the Past</em>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> Although the specifics differ a bit from as described in <em>A Link to the Past</em>– as all legends do when passed down through time– <em>Ocarina of Time</em> does depict Ganondorf obtaining the Triforce and sages sealing Ganon away. If the series had ended for good right here, we’d have a nice, neat chronology (omitting <em>Link’s Awakening</em>):</p>
<ul>
<li><em>Ocarina of Time</em>
<ul>
<li>A tale of the Imprisoning War, which seals Ganon away</li>
</ul></li>
<li><em>A Link to the Past</em>
<ul>
<li>Link thwarts Ganon attempting to break from his seal</li>
</ul></li>
<li><em>The Legend of Zelda</em>
<ul>
<li>After many years, the Triforce has been split within Hyrule’s Royal Family, and a revived Ganon seeks the Triforce of Wisdom after obtaining the Triforce of Power</li>
</ul></li>
<li><em>Zelda II: The Adventure of Link</em>
<ul>
<li>Link embarks on a quest to find the Triforce of Courage</li>
</ul></li>
</ul>
<p>At the risk of alienating readers unfamiliar with the series, but who have stuck with this article so far, I want to briefly outline the so-called “timeline split” that has generated infamous discourse in the <em>Zelda</em> fan community. <em>Ocarina of Time</em> introduced a time-travel mechanic between Link’s childhood and adulthood where the game technically has two different endings depending on Link’s age. In one scenario, after Link defeats Ganon as an adult, life carries on, and Hyrule’s future unfolds as everything in <em>Ocarina of Time</em> concludes. In the other scenario, still after Link defeats Ganon as an adult— and therefore Ganon is vanquished for good, no matter what– Princess Zelda sends Link back to his childhood so that he can experience the younger years he missed out on, without concern for Ganon re-appearing. These two timelines are known as the “Adult Timeline” and “Child Timeline,” respectively.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/zelda-timeline-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><em>Promotional artwork for Ocarina of Time, which for the first time in the series, presents in cinematic fashion a grand conflict between Ganondorf (upper left), Link in two distinct life stages (middle), and Princess Zelda (upper right). Looks like a movie poster, doesn’t it?</em></p>
<p>The next games relevant for the plot point I’m focusing on, <em>The Legend of Zelda: The Wind Waker</em> and <em>The Legend of Zelda: Twilight Princess</em>, are each placed in one of these timelines. <em>The Wind Waker</em> follows Hyrule in the Adult Timeline after <em>Ocarina of Time</em> ends, and <em>Twilight Princess</em> explores what happens after Link returns to his childhood in a Ganon-free Hyrule. In each of these games, Ganondorf awakens again, but is summarily defeated.</p>
<p>Do you notice a problem with this?</p>
<p>After <em>Ocarina of Time</em>, in either the Child or Adult timelines, Ganondorf is no more. Furthermore, Nintendo has since deemed <em>Ocarina of Time</em> a standalone story separate from the Imprisoning War. So how is Ganondorf supposed to break from his initial seal and set forth the events seen in <em>A Link to the Past</em>?</p>
<p>The answer is, he can’t. Intentionally or not, by cementing Ganondorf’s eventual downfall in both <em>The Wind Waker</em> and <em>Twilight Princess</em>, the developers wrote the backstory to <em>A Link to the Past</em> out of existence. While <em>Ocarina of Time</em> was supposed to be a prequel to <em>A Link to the Past</em>, its subsequent sequels ended up <em>erasing</em> it!</p>
<p>Nintendo has admitted, clearly and on multiple occasions, that the story of <em>Zelda</em> is an afterthought and that gameplay always comes first. This does make sense, I guess, because they are video games, after all, not screenplays or novels. Remember how I mentioned earlier that, more than anything, <em>Zelda</em> to me is about exploration? I’ve come to realize that exploration for exploration’s sake is not actually what makes it special. Exploration is about <em>meaning</em>, about discovering something significant, about the thrill of learning that this pathway actually connects to this other pathway, that there are these hidden treasures over here, though watch out for the monsters guarding them, or that there are these fantastic animals over there, yet you have to journey through a really dark cave to get to the other side. Exploration is about testing your boundaries and reaching the limits of what you know, and also what you’re <em>willing</em> to know. There’s no <em>right</em> way to explore, but there <em>is</em> a wrong way, and exploration without preparation is just recklessness. What Nintendo did with their official timeline is reckless, and it really does harm the meaning that fans had created with the experiences of their games, of exploring <em>this</em> world and all its intricacies.</p>
<p>Especially because, in my opinion, their solution was never necessary in the first place.</p>
<p>First, the canonical decree. In Nintendo’s timeline, they claim that <em>Ocarina of Time</em> produces not two splits, but <em>three</em>. In the third branch, which does not have an official name but is commonly referred to as the “Fallen Hero Timeline” or the “Downfall Timeline,” Link is defeated at the hands of Ganondorf, who then unites the Triforce in full and is still consequently sealed by the assembled sages. At first brush, this seems like a clever trick to explain how Ganondorf can possess the Triforce prior to <em>A Link to the Past</em> and also get sealed away. Unfortunately, given the specifics of what occurs in <em>Ocarina of Time</em>, this creates many inconsistencies, and I won’t go into them here. The bigger problem is that by creating the timeline split in this way– at the defeat of the hero in <em>only</em> this instance for this <em>one</em> game (let alone that this outcome is not actually ever portrayed, barring a <em>Game Over</em> screen)– it’s painfully obvious that this hand-waving is an after-the-fact move done by Nintendo without regard to consistency across the series. Link’s defeat in any other game, of course, does not create a parallel timeline split. To quote the US Supreme Court’s opinion in <em>Bush v. Gore</em> (yikes), Nintendo may have as well said that this ruling is limited to the present circumstances.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>I get it. Nintendo found themselves backed into a corner, faced with the difficult task of reconciling older games, written with an internally consistent framework, with a re-designed, more complex direction for the series. I would have felt better if they just declared a reboot, though, an acknowledgment of the vagaries inherent in any creative process. Instead, we got a borderline arrogant insistence that this was planned all along– when it clearly wasn’t.</p>
<p>Why? Let me describe, again briefly, an oft-forgotten title released in between <em>The Wind Waker</em> and <em>Twilight Princess</em>– <em>The Legend of Zelda: Four Swords Adventures</em>. Possibly the lowest selling game in the series, this multiplayer-focused entry may, in fact, be the missing link for all of these disparate threads. Without going in-depth about it, there is credible evidence to suppose that during development, <em>this</em> was meant to tell the story of the Imprisoning War, or at least some part of it.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> There are elements of sages, seals, Royal Knights, and dark realms, all things that mesh perfectly with the eras of both <em>Ocarina of Time</em> and <em>A Link to the Past</em>; Ganon even acquires a trident, which he also wields prominently in <em>A Link to the Past</em>. Much of this deep story, though, was cut for the game’s final release, so the analysis I’m laying out is merely hypothetical. Since Ganondorf is extinguished at the finale of the <em>Twilight Princess</em>, and <em>Four Swords Adventures</em> includes a surprise resurrection of Ganondorf, we can readily place <em>Twilight Princess</em> prior to <em>Four Swords Adventures</em>. And then, suddenly, it flows (other games still omitted):</p>
<p><strong>Initial Narrative</strong></p>
<ul>
<li><em>Ocarina of Time</em>
<ul>
<li>An independent tale, concluding with sealing Ganon away</li>
</ul></li>
</ul>
<p><strong>Child Timeline</strong></p>
<ul>
<li><em>Twilight Princess</em>
<ul>
<li>Link defeats Ganon who has escaped from the seal</li>
</ul></li>
<li><em>Four Swords Adventures</em>
<ul>
<li>Link uses the Four Sword to seal away the resurrected Ganon, in either a re-imagining or direct depiction of the Imprisoning War</li>
</ul></li>
<li><em>A Link to the Past</em>
<ul>
<li>Link thwarts Ganon attempting to break from his seal</li>
</ul></li>
<li><em>The Legend of Zelda</em>
<ul>
<li>After many years, the Triforce has been split within Hyrule’s Royal Family, and a revived Ganon seeks the Triforce of Wisdom after obtaining the Triforce of Power</li>
</ul></li>
<li><em>Zelda II: The Adventure of Link</em>
<ul>
<li>Link embarks on a quest to find the Triforce of Courage</li>
</ul></li>
</ul>
<p><strong>Adult Timeline</strong></p>
<ul>
<li><em>The Wind Waker</em>
<ul>
<li>Many years after the defeat of Ganon, his darkness returns once again and the goddesses decide to flood Hyrule, generating the Great Sea</li>
</ul></li>
</ul>
<p>It’s almost too neat, isn’t it? The problem with this proposal, from Nintendo’s perspective, is that <em>A Link to the Past</em> is separated from <em>Ocarina of Tme</em> by two intermediary games. They have emphasized that <em>Ocarina of Time</em> should immediately precede <em>A Link to the Past</em>, and so rather than illuminate a potential scenario where <em>Four Swords Adventures</em> bridges the plot gap, they chose to create the third timeline. It’s imperfect, sure, but so would anything else. I just think that my explanation here is simpler and more supported by the games themselves– while also giving more credence to an entry (<em>Four Swords Adventures</em>) that has an otherwise awkward placement in the official timeline.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/zelda-timeline-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p><em>Japanese box art for Four Swords Adventures. It almost looks like… a big war.</em></p>
<p>I recognize that this essay doesn’t accomplish much. Nintendo will never read it, nor will they ever alter the timeline. I don’t think they should, either. A new direction and a new fandom has emerged, excited about this official telling. That’s fine with me,<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> and I do like that there are three branches each corresponding to a piece of the Triforce. For some reason, though, writing this out gives me the closure that I need to square the circle of my favorite set of stories, to forge my own path in contrast with a narrative otherwise dictated from the top-down, as a way to mark my own exploration against the backdrop of a world that increasingly seems to resist open-ended personalization. This might not be <em>the</em> Zelda timeline, but it’s <em>mine</em>, and I think that’s the key.</p>
<p><em>Your readership is more than enough. Still, if you’d like to <a href="https://buymeacoffee.com/dmerullo" target="_blank">buy me a coffee</a>, it’s the clearest signal to keep writing.</em></p>




<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Thanks for the idea, Martin Luther.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>“Beauty perishes in life, but is immortal in art.”<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I liked the “Triforce Wish Theory” for awhile, but changed my mind after coming across the reference in (6).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>“The story in Ocarina of Time isn’t actually original, it deals with the Sages’ Imprisoning War from the Super Famicom’s ALttP.” <a href="https://glitterberri.com/ocarina-of-time/1101-interviews/ganondorf/">English Translation</a> from the <a href="https://www.1101.com/nintendo/nin1/nin1-6.htm">original Japanese</a>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>“Our consideration is limited to the present circumstances, for the problem of equal protection in election processes generally presents many complexities.” In other words, not setting a legal precedent.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><a href="https://www.zeldadungeon.net/the_untold_story_of_four_swords_adventures/">https://www.zeldadungeon.net/the_untold_story_of_four_swords_adventures/</a><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Except how <em>Tears of the Kingdom</em> names a completely unrelated battle <em>also</em> “the” Imprisoning War, and introduces a new and totally different Ganondorf. <em>That</em> really bothers me.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>